name: Deploy chat-docs-library to EC2

on:
 push:
  branches:
   - prod

jobs:
 deploy:
  runs-on: ubuntu-latest

  steps:
   - name: Checkout Repository
     uses: actions/checkout@v2

   - name: Install Dependencies
     run: pnpm install

   - name: Build Application
     run: pnpm build

   - name: Deploy to EC2
     uses: appleboy/ssh-action@master
     with:
      host: ${{ env.EC2_IP_ADDRESS }}
      username: ${{ env.EC2_USERNAME }}
      key: ${{ env.EC2_PRIVATE_KEY }}
      script: |
       cd  ../../chat-docs-library
       git pull origin main
       pnpm install
       pm2 restart your-app
