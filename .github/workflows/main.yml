name: Deploy chat-docs-library to EC2

on:
 push:
  branches:
   - prod

jobs:
 deploy:
  runs-on: ubuntu-latest

  steps:
   - name: Checkout Repository
     uses: actions/checkout@v2

   - name: Pull and install in EC2
     uses: appleboy/ssh-action@v1.0.3
     with:
      host: ${{ secrets.EC2_IP_ADDRESS }}
      username: ${{ secrets.EC2_USERNAME }}
      key: ${{ secrets.EC2_PRIVATE_KEY }}
      script: |
       cd chat-docs-library
       git pull
       pnpm install
       rm -rf .next
      #  pnpm run build
      #  pm2 restart chat-docs-library
      #  pm2 start npm --name chat-docs-library -- run start -- -p 3000
